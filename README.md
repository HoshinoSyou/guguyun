# guguyun
## 红岩网校2020年春期暑假考核
### 考核选项A 网盘
大家平时都会用到网盘(x)，有没有想过如果自己去实现一个网盘呢？
#### 基础（确实
文件上传 
文件下载
登录注册
权限管理
文件分享
#### 进阶（大概不难
一次性快传
断点续传
加密分享链接
二维码分享链接
下载限速
### 已实现功能
- 文件上传
使用gin框架中的c.FormFile获取文件，文件存于./file中
- 文件下载
用os.Open打开文件后利用gin框架中ctx.Writer.Header().Add以及io.Copy下载文件（或等价为ctx.File）
- 登陆注册
优化了数据库与业务层操作
- 权限管理
利用jwt（token）进行鉴权，并利用token中的username参数传出为uploader来判断是否是本人操作
- 文件分享
利用随机数生成1000-9999的key（邀请码）与path传入的value作为键值对创建map，并同时修改File结构体中的ShareAble为true
- 加密分享链接
自己写的一个基于base64的加密函数
- 二维码分享链接
利用go-qrcode框架生成二维码并放入./qrcode中，再利用io流传出
### 额外完成的功能
- 对用户账户的修改密码、注销账户操作
- 对文件的查看、搜索、修改信息、删除操作
### 完成但并没有使用的功能
- 下载限速
- 针对goroutine使用
- 利用mutex与time.Duration、time.sleep对goroutine进行限制
- 利用time.Now().Sun(lastFunc)上一次执行到现在的间隔时间与time.Duration进行比较判断是否达到限速目的
### 未完成的功能
- 断点续传
计划创建新文件来进行边复制、边记录、边传数据
- 一次性快传
未弄清题目含义
### 需要记录的部分
- 本次项目采用mvc架构，由控制器层controller -> 业务逻辑层service -> 模型层models
- 下载限速做的SpeedLimit函数目的是通过断点续传中使用goroutine实现，但由于io流bug与时间和个人兴奋度问题未能实现断点续传，因此下载限速的相关函数并未使用
### 出现的问题或bug
- io流部分的数据传递与处理（已解决）
- 未启动MySQL服务导致传递空指针DB（已解决）
- user结构体定义时未大写首字母导致调用出错（已解决）
- err.Error（）方法的错误使用导致的空指针或空地址问题（已解决）
- 对分享链接的加密规则，使用密码学的Aes等还是自己编写加密规则（已解决）
- 二维码的生成是否可以仅用go原生标准库完成（暂时使用go-qrcode框架）
- token的解析问题（曾未出现过）（暂未解决）
- 函数之间的传参与声明问题（下划白线）（已解决）
### 总结
- 本此项目先开始较为得心应手，到后面文件操作出现些许滞缓，进阶操作时学习了很多地方的思想才解决
- 目前已经可以将mvc架构分的较为明确，没有出现以前一样的结构错乱的情况
- 本身想使用这学期讲过的消息队列（？）、websocket或socket通信解决上传、下载文件，但担忧时间是否充足选择其他方法解决
- 还是需要多写项目，打算过后将这个项目完成，并使其功能更加完善
